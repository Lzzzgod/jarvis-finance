<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.pluggy.ai/pluggy-connect/v2.6.1/pluggy-connect.js"></script>
    <title>Open Finance - Jarvis</title>
</head>
    <body>
        {% extends 'layout.html' %}

        {% block title %}{% endblock %}

        {% block content %}
        <section class="open-finance">
          <div class="container">
              <div class="content">
                  <h2>Open Finance</h2>
                  <p>Conecte suas contas bancárias de forma segura</p>
  
                  <div class="banks-container">
                      <!-- Status das conexões -->
                      <div class="connection-status">
                          <h3>Status das Conexões</h3>
                          <div id="connected-banks">
                              <!-- Bancos conectados serão listados aqui dinamicamente -->
                          </div>
                      </div>
  
                      <button id="connectAccountBtn" class="connect-button">
                        <i class="fas fa-plus-circle"></i>
                        Conectar Nova Conta
                    </button>

                  <!-- Modal de conexão -->
                  <div id="connectionModal" class="modal">
                    <div class="modal-content">
                        <span class="close" onclick="closeModal()">×</span>
                        <h2>Conectar Conta Bancária</h2>
                        
                        <div class="connection-step" id="bankSelection">
                            <h3>Selecione seu banco</h3>
                            <div class="bank-list" id="bank-list">
                                <!-- Lista de bancos será preenchida via JavaScript -->
                            </div>
                        </div>
  
                          <!-- Etapa 2: Termos de consentimento -->
                          <div class="connection-step" id="consentStep" style="display: none;">
                              <h3>Termos de Consentimento</h3>
                              <div class="consent-text">
                                  <p>Ao prosseguir, você autoriza:</p>
                                  <ul>
                                      <li>Acesso somente leitura às suas informações bancárias</li>
                                      <li>Compartilhamento seguro de dados de transações</li>
                                      <li>Sincronização automática de movimentações</li>
                                  </ul>
                              </div>
                              <div class="consent-check">
                                <input type="checkbox" id="consentCheck">
                                <label for="consentCheck">Li e aceito os termos de consentimento</label>
                            </div>
                          </div>
  
                          <!-- Etapa 3: Status da conexão -->
                          <div class="connection-step" id="connectionStatus" style="display: none;">
                              <div class="status-indicator">
                                  <div class="spinner"></div>
                                  <p>Estabelecendo conexão segura...</p>
                              </div>
                          </div>
  
                          <div class="modal-footer">
                            <button id="prevStep" class="button secondary" style="display: none;">Voltar</button>
                            <button id="nextStep" class="button primary" disabled>Continuar</button>
                        </div>
                      </div>
                  </div>
              </div>
          </div>
      </section>
      <script type="text/javascript" src="{{ url_for('static', filename='js/open_finance_scripts.js') }}"></script>
        {% endblock %}
    </body>
</html>
